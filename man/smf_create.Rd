% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SMF.R
\name{smf_create}
\alias{smf_create}
\title{Create the mzTab-M Small Molecule Feature (SMF) Table}
\usage{
smf_create(
  ...,
  smf_df,
  exp_mass_to_charge = NULL,
  retention_time_in_seconds = NULL,
  retention_time_in_seconds_start = NULL,
  retention_time_in_seconds_end = NULL,
  SME_ID_REFS = NULL,
  SME_ID_REF_ambiguity_code = NULL,
  charge = NULL,
  adduct_ion = NULL,
  isotopomer = NULL
)
}
\arguments{
\item{...}{Additional optional columns to add. These arguments must be named.
The function will automatically prepend \code{"opt_"} to the names if not
already present.}

\item{smf_df}{\code{matrix} or \code{data.frame} of abundances. Rows are features,
columns are assays. The order of columns is assumed to match the order of
assays defined in the Metadata (MTD) section.}

\item{exp_mass_to_charge}{\code{numeric} vector of experimental m/z values.
\strong{Cannot} be \code{NULL}.}

\item{retention_time_in_seconds}{\code{numeric} vector of retention times in
seconds. Defaults to \code{"null"}.}

\item{retention_time_in_seconds_start}{\code{numeric} vector of start retention
times in seconds. Defaults to \code{"null"}.}

\item{retention_time_in_seconds_end}{\code{numeric} vector of end retention times
in seconds. Defaults to \code{"null"}.}

\item{SME_ID_REFS}{\code{character} vector of SME IDs referencing small molecules.
Defaults to \code{"null"}.}

\item{SME_ID_REF_ambiguity_code}{\code{character} vector of ambiguity codes for
SME ID references. Defaults to \code{"null"}.}

\item{charge}{\code{integer} vector of charge states. Defaults to \code{"null"}.}

\item{adduct_ion}{\code{character} vector of adducts (e.g. \code{"[M+H]+"}).
Defaults to \code{"null"}.}

\item{isotopomer}{\code{character} vector for isotopomer description.
Defaults to \code{"null"}.}
}
\value{
A complete SMF \code{data.frame} ready for export. The data frame contains
the 'SFH' line prefix, standard columns ordered according to spec,
abundance columns, and any optional columns.
}
\description{
The Small Molecule Feature (SMF) section of the mzTab-M definition captures
information on the individual MS features (quantified regions, e.g.,
elution profiles of specific m/z and retention times) that were measured
across the assays.

\code{smf_create()} provides a simplified workflow to generate this table in a
single step. It takes a matrix of abundances (rows=features, columns=assays)
and optional vectors defining feature properties.

It automatically:
\itemize{
\item Formats the abundance matrix (renaming columns to \code{abundance_assay[n]}).
\item Adds the required \code{SMF_ID} and standard mzTab-M columns (e.g.,
\code{exp_mass_to_charge}).
\item Populates missing mandatory columns with \code{"null"} strings to ensure
compliance.
\item Sets the line prefix column \code{SFH} to \code{"SMF"}.
\item Orders columns according to the mzTab-M specification.
}

\strong{Important:} to support the optional additional parameters passed along
with \code{...} \strong{all} parameters (such as \code{adduct_ion},
\code{retention_time_in_seconds} etc) have to be \strong{fully} spelled out.

See also the \href{https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc#64-small-molecule-feature-smf-section}{specification of the SMF section}
for details.
}
\examples{

## Assume we have a matrix of abundances (e.g., from xcms or similar tools)
## Rows are features, Columns are Samples/Assays.
abund_mat <- matrix(
    c(100.1, 105.2, 110.3,
      200.5, 198.2, 201.0,
      50.0, 55.0, 52.1),
    nrow = 3, byrow = TRUE
)

## Define feature metadata (vectors must match number of rows in matrix)
mz_values <- c(150.05, 200.10, 300.15)
rt_values <- c(20.5, 35.1, 40.0)
adducts <- c("[M+H]+", "[M+Na]+", "[M+H]+")

## Create the final dataframe ready for export
## Note: Fields not provided (like charge) are automatically set to "null"
smf_final <- smf_create(
    smf_df = abund_mat,
    exp_mass_to_charge = mz_values,
    retention_time_in_seconds = rt_values,
    adduct_ion = adducts,
    ## Optional custom column example
    global_custom_attribute = c("A", "B", "C")
)

## The result contains the 'SFH' line prefix, standard columns, and
## abundances
head(smf_final)
}
\author{
Philippine Louail, Johannes Rainer
}
