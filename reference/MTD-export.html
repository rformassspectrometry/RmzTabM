<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Defining and exporting the mzTab-M metadata table — MTD-export • RmzTabM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Defining and exporting the mzTab-M metadata table — MTD-export"><meta property="og:description" content="The metadata section/table of the mzTab-M definition is comprehensive, but
also tricky to define. The *rmzTabM* package provides a variety of utility
functions that help defining this information. These might be re-used for
software package developers to export metabolomics results from their
respective software. Importantly, the helper functions listed here only
define the core elements for the MTD section, helping with re-arranging and
reformatting information available e.g. in `data.frame` format into the
respective fields in the MTD section. Additional (optional) fields might
need to be added manually depending on availability for an experiment.
See also the [specification of the MTD section](https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc#62-metadata-section)
for details and more information, in particular on the format of the mzTab-M
and on mandatory or optional fields.
Generally, MTD data can be categarized into the following parts:
- *Core information*: general information on the experiment. A minimal
  set can be created using the [mtd_skeleton()] function, which might be
  further expanded with additional fields. This section allows to describe
  the general experimental setup. Also, it should contain references to
  **all** controlled vocabulary (CV) ontologies used and refered to in the
  mzTab-M file.
- *Sample information*: optional information on individual samples that were
  measured with the various *assays*/*runs*. The [mtd_sample()] function
  assists in compiling the information for this section.
- *MS run information*: information on the individual MS *runs*
  (measurements of the samples). Each data file is one run. Use the
  [mtd_ms_run()] function to define this part of the metadata section.
- *Assay information*: the [mtd_assay()] function assists in compiling the
  assay section of the metadata. Mandatory fields are the name (ID) of the
  assay and the reference to the *MS run* in which the assay was measured.
  Optional information on sample reference, external links or custom
  information can be provided too. In most cases (except multiplexed assays
  or pre-fractionated samples) one assay will link to one MS run. Each assay
  **must** represent one column in the following *abundance matrix* sections.
- *Study variable information*: the [mtd_study_variables()] function allows
  to format study variable information from an experiment into the mzTab-M
  format. All study variables need to be assigned to at least one assay and
  must also be reported in the subsequent abundance matrices.
The helper function listed above can be used sequentially to create the
metadata information. See the examples below for a general approach how to
define the MTD section of an experiment.
In addition, various helper functions are available to assist in MTD data
generation:
- [mtd_sort()]: to sort the MTD `matrix` into the expected order.
- [mtd_fields()]: helps formatting values into the mzTab-M-specific format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RmzTabM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.97.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/RmzTabM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Defining and exporting the mzTab-M metadata table</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/RmzTabM/blob/main/R/MTD.R" class="external-link"><code>R/MTD.R</code></a></small>
    <div class="hidden name"><code>MTD-export.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The metadata section/table of the mzTab-M definition is comprehensive, but
also tricky to define. The *rmzTabM* package provides a variety of utility
functions that help defining this information. These might be re-used for
software package developers to export metabolomics results from their
respective software. Importantly, the helper functions listed here only
define the core elements for the MTD section, helping with re-arranging and
reformatting information available e.g. in `data.frame` format into the
respective fields in the MTD section. Additional (optional) fields might
need to be added manually depending on availability for an experiment.</p>
<p>See also the [specification of the MTD section](https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc#62-metadata-section)
for details and more information, in particular on the format of the mzTab-M
and on mandatory or optional fields.</p>
<p>Generally, MTD data can be categarized into the following parts:</p>
<p>- *Core information*: general information on the experiment. A minimal
  set can be created using the [mtd_skeleton()] function, which might be
  further expanded with additional fields. This section allows to describe
  the general experimental setup. Also, it should contain references to
  **all** controlled vocabulary (CV) ontologies used and refered to in the
  mzTab-M file.</p>
<p>- *Sample information*: optional information on individual samples that were
  measured with the various *assays*/*runs*. The [mtd_sample()] function
  assists in compiling the information for this section.</p>
<p>- *MS run information*: information on the individual MS *runs*
  (measurements of the samples). Each data file is one run. Use the
  [mtd_ms_run()] function to define this part of the metadata section.</p>
<p>- *Assay information*: the [mtd_assay()] function assists in compiling the
  assay section of the metadata. Mandatory fields are the name (ID) of the
  assay and the reference to the *MS run* in which the assay was measured.
  Optional information on sample reference, external links or custom
  information can be provided too. In most cases (except multiplexed assays
  or pre-fractionated samples) one assay will link to one MS run. Each assay
  **must** represent one column in the following *abundance matrix* sections.</p>
<p>- *Study variable information*: the [mtd_study_variables()] function allows
  to format study variable information from an experiment into the mzTab-M
  format. All study variables need to be assigned to at least one assay and
  must also be reported in the subsequent abundance matrices.</p>
<p>The helper function listed above can be used sequentially to create the
metadata information. See the examples below for a general approach how to
define the MTD section of an experiment.</p>
<p>In addition, various helper functions are available to assist in MTD data
generation:</p>
<p>- [mtd_sort()]: to sort the MTD `matrix` into the expected order.
- [mtd_fields()]: helps formatting values into the mzTab-M-specific format.</p>
    </div>


    <div id="note">
    <h2>Note</h2>
    <p>The general relationship between *ms_run*, *assay* and *sample*:</p>
<p>- one *ms_run* is the measurement of one assay.</p>
<p>- one assay can be measured by several MS runs (if fractionated) or multiple
  assays can be measured in the same MS run (if multiplexed).</p>
<p>- one assay is (generally) one sample, but the same sample can be measured
  with multiple assays.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Philippine Louail, Johannes Rainer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Building the mzTab-M metadata information from a `data.frame` with sample</span></span></span>
<span class="r-in"><span><span class="co">## information of an experiment. Each row in that `data.frame` is one</span></span></span>
<span class="r-in"><span><span class="co">## measurement of one sample (i.e., represents one *ms_run*). Columns in</span></span></span>
<span class="r-in"><span><span class="co">## that `data.frame` provide the phenotypic and experimental variables of</span></span></span>
<span class="r-in"><span><span class="co">## each sample. The example below represents a simple experiment in which</span></span></span>
<span class="r-in"><span><span class="co">## 3 samples (e.g. cell lines) were measured, each at two different time</span></span></span>
<span class="r-in"><span><span class="co">## points (0 and 6 hours). In addition, one sample has the genotype *WT* and</span></span></span>
<span class="r-in"><span><span class="co">## two *KO*. Column `"operator"` contains the initials of the researcher</span></span></span>
<span class="r-in"><span><span class="co">## extracting the samples</span></span></span>
<span class="r-in"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1_T1"</span>, <span class="st">"S1_T2"</span>, <span class="st">"S2_T1"</span>, <span class="st">"S2_T2"</span>, <span class="st">"S3_T1"</span>, <span class="st">"S3_T2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    timepoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0h"</span>, <span class="st">"6h"</span>, <span class="st">"0h"</span>, <span class="st">"6h"</span>, <span class="st">"0h"</span>, <span class="st">"6h"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    operator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"FB"</span>, <span class="st">"FB"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1-t1.mzML"</span>, <span class="st">"s1-t2.mzML"</span>, <span class="st">"s2-t1.mzML"</span>, <span class="st">"s2-t2.mzML"</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"s3-t1.mzML"</span>, <span class="st">"s3-t2.mzML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">exp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample_name sample_id timepoint genotype operator  file_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       S1_T1        S1        0h       WT       BB s1-t1.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       S1_T2        S1        6h       WT       BB s1-t2.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       S2_T1        S2        0h       KO       BB s2-t1.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       S2_T2        S2        6h       KO       BB s2-t2.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       S3_T1        S3        0h       KO       FB s3-t1.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       S3_T2        S3        6h       KO       FB s3-t2.mzML</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Core metadata information</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We first compile the general metadata information. For the present</span></span></span>
<span class="r-in"><span><span class="co">## example we assume that we performed only preprocessing of the raw MS</span></span></span>
<span class="r-in"><span><span class="co">## data using *xcms*, thus we don't specify annotation databases used for</span></span></span>
<span class="r-in"><span><span class="co">## the compound identification/annotation. These could be provided through</span></span></span>
<span class="r-in"><span><span class="co">## the `database*` parameters. Also, the quantification method and unit(s)</span></span></span>
<span class="r-in"><span><span class="co">## could be specified using respective parameters of the function.</span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_skeleton.html">mtd_skeleton</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    id <span class="op">=</span> <span class="st">"EXP_001"</span>,</span></span>
<span class="r-in"><span>    software <span class="op">=</span> <span class="st">"[MS, MS:1001582], xcms, 4.0.0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mtd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "mzTab-version"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "mzTab-ID"                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "software[1]"                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "quantification_method"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "cv[1]-label"                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "cv[1]-full_name"                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "cv[1]-version"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "cv[1]-uri"                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "cv[2]-label"                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "cv[2]-full_name"                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "cv[2]-version"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "cv[2]-uri"                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "database[1]"                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "database[1]-prefix"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "database[1]-version"                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] "database[1]-uri"                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] "small_molecule-quantification_unit"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] "small_molecule_feature-quantification_unit"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] "small_molecule-identification_reliability" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,2]                                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "2.0.0-M"                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "id"                                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "[MS, MS:1001582], xcms, 4.0.0"                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "[MS, MS:1001834, LC-MS label-free quantitation analysis, ]"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "MS"                                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "PSI-MS controlled vocabulary"                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "4.1.138"                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "https://raw.githubusercontent.com/HUPO-PSI/psi-ms-CV/master/psi-ms.obo" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "PRIDE"                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "PRIDE PRoteomics IDEntifications (PRIDE) database controlled vocabulary"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "16:10:2023 11:38"                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "https://www.ebi.ac.uk/ols/ontologies/pride"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "[,, \"no database\", null ]"                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "null"                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "Unknown"                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] "null"                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] "[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] "[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] "[MS, MS:1002896, compound identification confidence level, ]"           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We next manually add a title and description for the experiment.</span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mtd</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"title"</span>, <span class="st">"Experiment 1 preprocessed data"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"description"</span>, <span class="st">"The preprocessed data of the experiment 1 samples."</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We also add information on the MS instrumentation used</span></span></span>
<span class="r-in"><span><span class="va">instr</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_fields.html">mtd_fields</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    name <span class="op">=</span> <span class="st">"[MS, MS:1000449, LTQ Orbitrap,]"</span>,</span></span>
<span class="r-in"><span>    source <span class="op">=</span> <span class="st">"[MS, MS:1000073, ESI,]"</span>,</span></span>
<span class="r-in"><span>    `analyzer[1]` <span class="op">=</span> <span class="st">"[MS, MS:1000291, linear ion trap,]"</span>,</span></span>
<span class="r-in"><span>    detector <span class="op">=</span> <span class="st">"[MS, MS:1000253, electron multiplier,]"</span>,</span></span>
<span class="r-in"><span>    field_prefix <span class="op">=</span> <span class="st">"instrument"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">instr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]                        [,2]                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] "instrument[1]-name"        "[MS, MS:1000449, LTQ Orbitrap,]"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] "instrument[1]-source"      "[MS, MS:1000073, ESI,]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] "instrument[1]-analyzer[1]" "[MS, MS:1000291, linear ion trap,]"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] "instrument[1]-detector"    "[MS, MS:1000253, electron multiplier,]"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add this information to the metadata</span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">instr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Other information, such as employed sample processing methods could be</span></span></span>
<span class="r-in"><span><span class="co">## added in a similar way.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Sample information</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We next add sample information to the metadata. In addition to the</span></span></span>
<span class="r-in"><span><span class="co">## specific sample properties that can be defined using the function's</span></span></span>
<span class="r-in"><span><span class="co">## parameters, arbitrary custom fields can be defined too. Below we add</span></span></span>
<span class="r-in"><span><span class="co">## information on sample extraction as custom information.</span></span></span>
<span class="r-in"><span><span class="va">mtd_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_sample.html">mtd_sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">exp</span><span class="op">$</span><span class="va">sample_id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    species <span class="op">=</span> <span class="st">"[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"</span>,</span></span>
<span class="r-in"><span>    tissue <span class="op">=</span> <span class="st">"[BTO, BTO:0000759, liver, ]"</span>,</span></span>
<span class="r-in"><span>    cell_type <span class="op">=</span> <span class="st">"[CL, CL:0000182, hepatocyte, ]"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[,,Extraction date, 2011-12-21]"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"[,,Extraction date, 2011-12-22]"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"[,,Extraction date, 2011-12-23]"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1</span>
<span class="r-in"><span><span class="va">mtd_s</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "sample[1]"              "S1"                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "sample[1]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "sample[1]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "sample[1]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "sample[1]-custom[1]"    "[,,Extraction date, 2011-12-21]"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "sample[2]"              "S2"                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "sample[2]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "sample[2]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "sample[2]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "sample[2]-custom[1]"    "[,,Extraction date, 2011-12-22]"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "sample[3]"              "S3"                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "sample[3]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "sample[3]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "sample[3]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "sample[3]-custom[1]"    "[,,Extraction date, 2011-12-23]"            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_s</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################################</span></span></span>
<span class="r-in"><span><span class="co">## MS run information</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The MS run information should capture information of each individual</span></span></span>
<span class="r-in"><span><span class="co">## measurement run on an MS instrument. For this, the original data file</span></span></span>
<span class="r-in"><span><span class="co">## names and location should be provided as well as the format of the</span></span></span>
<span class="r-in"><span><span class="co">## data files as well as polarity etc.</span></span></span>
<span class="r-in"><span><span class="va">mtd_msr</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_ms_run.html">mtd_ms_run</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    location <span class="op">=</span> <span class="va">exp</span><span class="op">$</span><span class="va">file_name</span>,</span></span>
<span class="r-in"><span>    format <span class="op">=</span> <span class="st">"[MS, MS:1000584, mzML file, ]"</span>,</span></span>
<span class="r-in"><span>    id_format <span class="op">=</span> <span class="st">"[MS, MS:1000530, mzML unique identifier, ]"</span>,</span></span>
<span class="r-in"><span>    scan_polarity <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_msr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Assay information</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Each measurement should be associated to (at least) one assay. For our</span></span></span>
<span class="r-in"><span><span class="co">## simple example, each row in the `data.frame` represents one assay, with</span></span></span>
<span class="r-in"><span><span class="co">## each assay being measured in one MS run.</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_assay.html">mtd_assay</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    assay <span class="op">=</span> <span class="va">exp</span><span class="op">$</span><span class="va">sample_name</span>,</span></span>
<span class="r-in"><span>    sample_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample[1]"</span>, <span class="st">"sample[1]"</span>, <span class="st">"sample[2]"</span>, <span class="st">"sample[2]"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"sample[3]"</span>, <span class="st">"sample[3]"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ms_run_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ms_run["</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0</span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "assay[1]"            "S1_T1"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "assay[1]-sample_ref" "sample[1]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "assay[1]-ms_run_ref" "ms_run[1]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "assay[2]"            "S1_T2"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "assay[2]-sample_ref" "sample[1]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "assay[2]-ms_run_ref" "ms_run[2]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "assay[3]"            "S2_T1"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "assay[3]-sample_ref" "sample[2]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "assay[3]-ms_run_ref" "ms_run[3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "assay[4]"            "S2_T2"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "assay[4]-sample_ref" "sample[2]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "assay[4]-ms_run_ref" "ms_run[4]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "assay[5]"            "S3_T1"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "assay[5]-sample_ref" "sample[3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "assay[5]-ms_run_ref" "ms_run[5]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] "assay[6]"            "S3_T2"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] "assay[6]-sample_ref" "sample[3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] "assay[6]-ms_run_ref" "ms_run[6]"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Study variable information</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Study variables can be defined directly from the experiment `data.frame`.</span></span></span>
<span class="r-in"><span><span class="co">## In our example we use the columns (information on) `"timepoint"`,</span></span></span>
<span class="r-in"><span><span class="co">## `"genotype"` and `"operator"`. Importantly, the order of the provided</span></span></span>
<span class="r-in"><span><span class="co">## `data.frame` has to match the order of the assays (and MS runs).</span></span></span>
<span class="r-in"><span><span class="va">svar</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_study_variables.html">mtd_study_variables</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">exp</span>,</span></span>
<span class="r-in"><span>    study_variable_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timepoint"</span>, <span class="st">"genotype"</span>, <span class="st">"operator"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">svar</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "study_variable[1]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "study_variable[1]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "study_variable[1]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "study_variable[1]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "study_variable[1]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "study_variable[2]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "study_variable[2]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "study_variable[2]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "study_variable[2]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "study_variable[2]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "study_variable[3]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "study_variable[3]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "study_variable[3]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "study_variable[3]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "study_variable[3]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] "study_variable[4]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] "study_variable[4]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] "study_variable[4]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] "study_variable[4]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] "study_variable[4]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] "study_variable[5]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] "study_variable[5]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] "study_variable[5]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] "study_variable[5]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] "study_variable[5]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] "study_variable[6]"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] "study_variable[6]-assay_refs"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] "study_variable[6]-average_function"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] "study_variable[6]-variation_function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] "study_variable[6]-description"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,2]                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "timepoint:0h"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "assay[1]|assay[3]|assay[5]"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "Column: timepoint, value: 0h"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "timepoint:6h"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "assay[2]|assay[4]|assay[6]"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "Column: timepoint, value: 6h"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] "genotype:WT"                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] "assay[1]|assay[2]"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] "Column: genotype, value: WT"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] "genotype:KO"                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] "assay[3]|assay[4]|assay[5]|assay[6]"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] "Column: genotype, value: KO"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] "operator:BB"                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] "assay[1]|assay[2]|assay[3]|assay[4]"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] "Column: operator, value: BB"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] "operator:FB"                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] "assay[5]|assay[6]"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] "[MS, MS:1002962, mean, ]"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] "[MS, MS:1002963, variation coefficient, ]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] "Column: operator, value: FB"              </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">svar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Finally, the `mtd_sort()` function can be used to sort the generated</span></span></span>
<span class="r-in"><span><span class="co">## two-column matrix in the expected order.</span></span></span>
<span class="r-in"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="mtd_sort.html">mtd_sort</a></span><span class="op">(</span><span class="va">mtd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## This metadata information can next be exported manually, or using the</span></span></span>
<span class="r-in"><span><span class="co">## dedicated export helper functions to an mzTab-M file.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nils Hoffmann, Steffen Neumann, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

      </footer></div>






  </body></html>

