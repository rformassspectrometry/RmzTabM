<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The R API for the mzTab-M File Format • RmzTabM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="rmztabm-api_files/libs/quarto-html/popper.min.js"></script><script src="rmztabm-api_files/libs/quarto-html/tippy.umd.min.js"></script><link href="rmztabm-api_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="rmztabm-api_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The R API for the mzTab-M File Format">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RmzTabM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.97.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rmztabm-api.html">The R API for the mzTab-M File Format</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/RmzTabM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The R API for the mzTab-M File Format</h1>




      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/RmzTabM/blob/main/vignettes/rmztabm-api.qmd" class="external-link"><code>vignettes/rmztabm-api.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>RmzTabM</em> package provides the API and core functionality to read and write files in mzTab-M format. The functions can be re-used and integrated by other R packages to support import and export of their respective metabolomics/lipidomics result objects in this format.</p>
</section><section class="section level2"><h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
</section><section class="section level2"><h2 id="r-mztab-m-api">R mzTab-M API<a class="anchor" aria-label="anchor" href="#r-mztab-m-api"></a>
</h2>
<p>The <em>RmzTabM</em> package provides low level, core functions and higher-level functions to work with files in mzTab-M format. The high-level functions are more user-oriented, simplifying the import and export of data and information from and to files in mzTab-M format. The low-level, core functions are developer-oriented, providing helper functions that can be re-used in other R packages to read and write from and to mzTab-M files.</p>
<p>For a description of the mzTab-M format and the set of mandatory and optional fields refer to the official <a href="https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc" class="external-link">format definition</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/RmzTabM" class="external-link">RmzTabM</a></span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level2"><h3 id="high-level-user-faced-functions">High-level, user faced functions<a class="anchor" aria-label="anchor" href="#high-level-user-faced-functions"></a>
</h3>
<p>TODO: implement these functions. These functions should simplify import/export taking more complex or multiple data parts (<code>data.frame</code>s, <code>matrix</code> etc) as input and write the formatted data directly to a mzTab-M file, or should read a mzTab-M file returning it’s content as e.g. a <code>list</code> of elements.</p>
</section><section class="level2"><h3 id="low-level-functions">Low-level functions<a class="anchor" aria-label="anchor" href="#low-level-functions"></a>
</h3>
<p>The low-level functions listed in this section provide the base functionality to convert or format information and data for/from the <a href="https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc" class="external-link">mzTab-M format</a>. These functions are designed to be re-used by other R packages and take and return only basic, plain R data types.</p>
<section class="level3"><h4 id="formatting-and-exporting">Formatting and exporting<a class="anchor" aria-label="anchor" href="#formatting-and-exporting"></a>
</h4>
<section class="level4"><h5 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h5>
<p>The mzTab-M format defines various fields and parameters to describe the data and information of an experiment. The <em>RmzTabM</em> package provides a variety of utility functions that help defining and formatting this information.</p>
<p>See also the <a href="https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc#62-metadata-section" class="external-link">specification of the MTD section</a> for more information and optional and mandatory metadata fields.</p>
<p>The general categories of the metadadata in the mzTab-M MTD section are <em>core information</em>, <em>sample information</em>, <em>MS run information</em>, <em>assay information</em> and <em>study variable information</em>. For each of these categories a separate R function is available to create and format the respective fields. As an example, we define below a <code>data.frame</code> with sample information. In our example we assume 3 samples (e.g. cell lines) each measured at two different time points. An additional column <em>genotype</em> specifies the genotype of the individual samples and a column <em>operator</em> the initials of the researcher extracting the samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Define a simple data.frame of the measured samples of an experiment</span></span>
<span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1_T1"</span>, <span class="st">"S1_T2"</span>, <span class="st">"S2_T1"</span>, <span class="st">"S2_T2"</span>, <span class="st">"S3_T1"</span>, <span class="st">"S3_T2"</span><span class="op">)</span>,</span>
<span>    sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S3"</span><span class="op">)</span>,</span>
<span>    timepoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0h"</span>, <span class="st">"6h"</span>, <span class="st">"0h"</span>, <span class="st">"6h"</span>, <span class="st">"0h"</span>, <span class="st">"6h"</span><span class="op">)</span>,</span>
<span>    genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"KO"</span><span class="op">)</span>,</span>
<span>    operator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"BB"</span>, <span class="st">"FB"</span>, <span class="st">"FB"</span><span class="op">)</span>,</span>
<span>    file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1-t1.mzML"</span>, <span class="st">"s1-t2.mzML"</span>, <span class="st">"s2-t1.mzML"</span>, <span class="st">"s2-t2.mzML"</span>,</span>
<span>                  <span class="st">"s3-t1.mzML"</span>, <span class="st">"s3-t2.mzML"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">exp</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sample_name sample_id timepoint genotype operator  file_name
1       S1_T1        S1        0h       WT       BB s1-t1.mzML
2       S1_T2        S1        6h       WT       BB s1-t2.mzML
3       S2_T1        S2        0h       KO       BB s2-t1.mzML
4       S2_T2        S2        6h       KO       BB s2-t2.mzML
5       S3_T1        S3        0h       KO       FB s3-t1.mzML
6       S3_T2        S3        6h       KO       FB s3-t2.mzML</code></pre>
</div>
</div>
<p>We will next compile the MTD information for the experiment using the individual helper functions, starting with the <strong>Core information</strong>: this comprises general information about the experiment. A minimal set of fields can be compiled using the <code><a href="../reference/mtd_skeleton.html">mtd_skeleton()</a></code> function. We have to provide an ID for the experiment and in addition we specify the software used to process the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_skeleton.html">mtd_skeleton</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"EXP_001"</span>,</span>
<span>    software <span class="op">=</span> <span class="st">"[MS, MS:1001582, xcms, 4.1.0]"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mtd</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
 [1,] "mzTab-version"
 [2,] "mzTab-ID"
 [3,] "software[1]"
 [4,] "quantification_method"
 [5,] "cv[1]-label"
 [6,] "cv[1]-full_name"
 [7,] "cv[1]-version"
 [8,] "cv[1]-uri"
 [9,] "cv[2]-label"
[10,] "cv[2]-full_name"
[11,] "cv[2]-version"
[12,] "cv[2]-uri"
[13,] "database[1]"
[14,] "database[1]-prefix"
[15,] "database[1]-version"
[16,] "database[1]-uri"
[17,] "small_molecule-quantification_unit"
[18,] "small_molecule_feature-quantification_unit"
[19,] "small_molecule-identification_reliability"
      [,2]
 [1,] "2.0.0-M"
 [2,] "id"
 [3,] "[MS, MS:1001582, xcms, 4.1.0]"
 [4,] "[MS, MS:1001834, LC-MS label-free quantitation analysis, ]"
 [5,] "MS"
 [6,] "PSI-MS controlled vocabulary"
 [7,] "4.1.138"
 [8,] "https://raw.githubusercontent.com/HUPO-PSI/psi-ms-CV/master/psi-ms.obo"
 [9,] "PRIDE"
[10,] "PRIDE PRoteomics IDEntifications (PRIDE) database controlled vocabulary"
[11,] "16:10:2023 11:38"
[12,] "https://www.ebi.ac.uk/ols/ontologies/pride"
[13,] "[,, \"no database\", null ]"
[14,] "null"
[15,] "Unknown"
[16,] "null"
[17,] "[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]"
[18,] "[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]"
[19,] "[MS, MS:1002896, compound identification confidence level, ]"           </code></pre>
</div>
</div>
<p>This represents some minimal information. The data of the MTD section is formatted as a <code>character</code> 2-column <code>matrix</code>. We could now either change the value (i.e., the elements in the second column of this matrix) of existing fields, or also manually add additional fields/information. As an example we add a title and description for the experiment. See also the <a href="https://github.com/HUPO-PSI/mzTab-M/blob/main/specification_documents/mzTab_format_specification_2_1-M.adoc#62-metadata-section" class="external-link">mzTab-M</a> format definition for other supported fields.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">mtd</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"title"</span>, <span class="st">"Experiment 1 preprocessed data"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"description"</span>, <span class="st">"The preprocessed data of the experiment 1."</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>To help with formatting we can also use the <code><a href="../reference/mtd_fields.html">mtd_fields()</a></code> function. Below we use this function to add information about the MS instrumentation to the MTD section:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">instr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_fields.html">mtd_fields</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"[MS, MS:1000449, LTQ Orbitrap,]"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"[MS, MS:1000073, ESI,]"</span>,</span>
<span>    `analyzer[1]` <span class="op">=</span> <span class="st">"[MS, MS:1000291, linear ion trap,]"</span>,</span>
<span>    detector <span class="op">=</span> <span class="st">"[MS, MS:1000253, electron multiplier,]"</span>,</span>
<span>    field_prefix <span class="op">=</span> <span class="st">"instrument"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">instr</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]                        [,2]
[1,] "instrument[1]-name"        "[MS, MS:1000449, LTQ Orbitrap,]"
[2,] "instrument[1]-source"      "[MS, MS:1000073, ESI,]"
[3,] "instrument[1]-analyzer[1]" "[MS, MS:1000291, linear ion trap,]"
[4,] "instrument[1]-detector"    "[MS, MS:1000253, electron multiplier,]"</code></pre>
</div>
</div>
<p>And we add that information to the <code>mtd</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">instr</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Note that the general information part should also contain the references to <strong>all</strong> controlled vocabulary (CV) ontologies used in the mzTab-M file. The default ontologies added by the <code>mtb_skeleton()</code> function are the <em>PSI-MS</em> and the <em>PRIDE</em> ontologies. If other vocabularies are used, they should be added manually (following the scheme of the others, i.e., the fields starting with <code>"cv["</code>).</p>
<p>The next category of metadata information is <strong>sample information</strong>. This comprises (optional) information on individual samples that were measured with the various assays/runs. We use the <code><a href="../reference/mtd_sample.html">mtd_sample()</a></code> function to assist in compiling this information. Parameters <code>sample</code>, <code>species</code>, <code>tissue</code> and <code>cell_type</code>, <code>disease</code> and <code>description</code> allow to provide pre-defined sample properties. Additional sample annotations and details can be provided through the function’s <code>...</code>. For the example below we define some of these properties and in addition provide a custom field for the extraction data. Be aware that <code><a href="../reference/mtd_sample.html">mtd_sample()</a></code> does <strong>not</strong> support partial or positional matching of parameters; for each of the parameters the <strong>full parameter name</strong> has to be used (i.e., <code>sample = ...</code> instead of <code>sam = ...</code> or <code>s = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_sample.html">mtd_sample</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">exp</span><span class="op">$</span><span class="va">sample_id</span><span class="op">)</span>,</span>
<span>    species <span class="op">=</span> <span class="st">"[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"</span>,</span>
<span>    tissue <span class="op">=</span> <span class="st">"[BTO, BTO:0000759, liver, ]"</span>,</span>
<span>    cell_type <span class="op">=</span> <span class="st">"[CL, CL:0000182, hepatocyte, ]"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[,,Extraction date, 2011-12-21]"</span>,</span>
<span>      <span class="st">"[,,Extraction date, 2011-12-22]"</span>,</span>
<span>      <span class="st">"[,,Extraction date, 2011-12-23]"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code><span><span class="fl">1</span></span></code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_s</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 [1,] "sample[1]"              "S1"
 [2,] "sample[1]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"
 [3,] "sample[1]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"
 [4,] "sample[1]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"
 [5,] "sample[1]-custom[1]"    "[,,Extraction date, 2011-12-21]"
 [6,] "sample[2]"              "S2"
 [7,] "sample[2]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"
 [8,] "sample[2]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"
 [9,] "sample[2]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"
[10,] "sample[2]-custom[1]"    "[,,Extraction date, 2011-12-22]"
[11,] "sample[3]"              "S3"
[12,] "sample[3]-species[1]"   "[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]"
[13,] "sample[3]-tissue[1]"    "[BTO, BTO:0000759, liver, ]"
[14,] "sample[3]-cell_type[1]" "[CL, CL:0000182, hepatocyte, ]"
[15,] "sample[3]-custom[1]"    "[,,Extraction date, 2011-12-23]"            </code></pre>
</div>
</div>
<p>We can then add this information to the <code>mtd</code> variable by simply <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>ing it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_s</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Next we compile <strong>MS run information</strong> of the experiment using the <code><a href="../reference/mtd_ms_run.html">mtd_ms_run()</a></code> helper function. This should comprise all (MS-specific) information related to the measurement of each sample - including also the MS data file names and locations. For our example we use the file names reported in the sample data frame and specify the polarity of the measurement runs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_msr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_ms_run.html">mtd_ms_run</a></span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="va">exp</span><span class="op">$</span><span class="va">file_name</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"[MS, MS:1000584, mzML file, ]"</span>,</span>
<span>    id_format <span class="op">=</span> <span class="st">"[MS, MS:1000530, mzML unique identifier, ]"</span>,</span>
<span>    scan_polarity <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span>
<span><span class="va">mtd_msr</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   values
 [1,] "ms_run[1]-location"         "s1-t1.mzML"
 [2,] "ms_run[1]-format"           "[MS, MS:1000584, mzML file, ]"
 [3,] "ms_run[1]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
 [4,] "ms_run[1]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"
 [5,] "ms_run[2]-location"         "s1-t2.mzML"
 [6,] "ms_run[2]-format"           "[MS, MS:1000584, mzML file, ]"
 [7,] "ms_run[2]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
 [8,] "ms_run[2]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"
 [9,] "ms_run[3]-location"         "s2-t1.mzML"
[10,] "ms_run[3]-format"           "[MS, MS:1000584, mzML file, ]"
[11,] "ms_run[3]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
[12,] "ms_run[3]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"
[13,] "ms_run[4]-location"         "s2-t2.mzML"
[14,] "ms_run[4]-format"           "[MS, MS:1000584, mzML file, ]"
[15,] "ms_run[4]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
[16,] "ms_run[4]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"
[17,] "ms_run[5]-location"         "s3-t1.mzML"
[18,] "ms_run[5]-format"           "[MS, MS:1000584, mzML file, ]"
[19,] "ms_run[5]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
[20,] "ms_run[5]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"
[21,] "ms_run[6]-location"         "s3-t2.mzML"
[22,] "ms_run[6]-format"           "[MS, MS:1000584, mzML file, ]"
[23,] "ms_run[6]-id_format"        "[MS, MS:1000530, mzML unique identifier, ]"
[24,] "ms_run[6]-scan_polarity[1]" "[MS, MS:1000130, positive scan, ]"         </code></pre>
</div>
</div>
<p>Each row in the <code>exp</code> data frame was assigned to a <code>"ms_run"</code> with the location and format of the respective file as well as the polarity in which the data was acquired. We can combine this data with the <code>mtd</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_msr</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Next we define the <strong>assay information</strong>. Generally, each measurement (MS run) is associated to one assay, but also more complex configurations are supported. See the help of the <code><a href="../reference/mtd_assay.html">mtd_assay()</a></code> function for details on multiplexed or pre-fractionated samples. Mandatory information that has to be provided to the <code><a href="../reference/mtd_assay.html">mtd_assay()</a></code> function are the name (ID) of the assay and the reference to the MS run in which the assay was measured. For the latter, a format of <code>"ms_run[&lt;index of the MS run&gt;]"</code> is expected. For our example we provide in addition also the (optional, but suggested) reference to the original sample. Note that each assay must represent one column in the following feature abundance table (SMF).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_assay.html">mtd_assay</a></span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">exp</span><span class="op">$</span><span class="va">sample_name</span>,</span>
<span>    sample_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample[1]"</span>, <span class="st">"sample[1]"</span>, <span class="st">"sample[2]"</span>, <span class="st">"sample[2]"</span>,</span>
<span>                   <span class="st">"sample[3]"</span>, <span class="st">"sample[3]"</span><span class="op">)</span>,</span>
<span>    ms_run_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ms_run["</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code><span><span class="fl">0</span></span></code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_a</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 [1,] "assay[1]"            "S1_T1"
 [2,] "assay[1]-sample_ref" "sample[1]"
 [3,] "assay[1]-ms_run_ref" "ms_run[1]"
 [4,] "assay[2]"            "S1_T2"
 [5,] "assay[2]-sample_ref" "sample[1]"
 [6,] "assay[2]-ms_run_ref" "ms_run[2]"
 [7,] "assay[3]"            "S2_T1"
 [8,] "assay[3]-sample_ref" "sample[2]"
 [9,] "assay[3]-ms_run_ref" "ms_run[3]"
[10,] "assay[4]"            "S2_T2"
[11,] "assay[4]-sample_ref" "sample[2]"
[12,] "assay[4]-ms_run_ref" "ms_run[4]"
[13,] "assay[5]"            "S3_T1"
[14,] "assay[5]-sample_ref" "sample[3]"
[15,] "assay[5]-ms_run_ref" "ms_run[5]"
[16,] "assay[6]"            "S3_T2"
[17,] "assay[6]-sample_ref" "sample[3]"
[18,] "assay[6]-ms_run_ref" "ms_run[6]"</code></pre>
</div>
</div>
<p>We add this information to the <code>mtd</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_a</span><span class="op">)</span></span></code></pre></div>
</div>
<p>At last we compile the <strong>study variable information</strong> of our example experiment. This should capture all experiment-relevant study variables. In R, such information is generally encoded in a <em>sample</em> or <em>phenotype</em> <code>data.frame</code>, with rows being individual samples (or measurements thereof) and columns the sample characteristics (i.e., the study variables). For our example we use the <code><a href="../reference/mtd_study_variables.html">mtd_study_variables()</a></code> function to generate the mzTab-M study variable information, specifying with parameter <code>study_variable_columns</code> the names of the <code>data.frame</code> containing the relevant information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd_svar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_study_variables.html">mtd_study_variables</a></span><span class="op">(</span></span>
<span>    <span class="va">exp</span>,</span>
<span>    study_variable_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timepoint"</span>, <span class="st">"genotype"</span>, <span class="st">"operator"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mtd_svar</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
 [1,] "study_variable[1]"
 [2,] "study_variable[1]-assay_refs"
 [3,] "study_variable[1]-average_function"
 [4,] "study_variable[1]-variation_function"
 [5,] "study_variable[1]-description"
 [6,] "study_variable[2]"
 [7,] "study_variable[2]-assay_refs"
 [8,] "study_variable[2]-average_function"
 [9,] "study_variable[2]-variation_function"
[10,] "study_variable[2]-description"
[11,] "study_variable[3]"
[12,] "study_variable[3]-assay_refs"
[13,] "study_variable[3]-average_function"
[14,] "study_variable[3]-variation_function"
[15,] "study_variable[3]-description"
[16,] "study_variable[4]"
[17,] "study_variable[4]-assay_refs"
[18,] "study_variable[4]-average_function"
[19,] "study_variable[4]-variation_function"
[20,] "study_variable[4]-description"
[21,] "study_variable[5]"
[22,] "study_variable[5]-assay_refs"
[23,] "study_variable[5]-average_function"
[24,] "study_variable[5]-variation_function"
[25,] "study_variable[5]-description"
[26,] "study_variable[6]"
[27,] "study_variable[6]-assay_refs"
[28,] "study_variable[6]-average_function"
[29,] "study_variable[6]-variation_function"
[30,] "study_variable[6]-description"
      [,2]
 [1,] "timepoint:0h"
 [2,] "assay[1]|assay[3]|assay[5]"
 [3,] "[MS, MS:1002962, mean, ]"
 [4,] "[MS, MS:1002963, variation coefficient, ]"
 [5,] "Column: timepoint, value: 0h"
 [6,] "timepoint:6h"
 [7,] "assay[2]|assay[4]|assay[6]"
 [8,] "[MS, MS:1002962, mean, ]"
 [9,] "[MS, MS:1002963, variation coefficient, ]"
[10,] "Column: timepoint, value: 6h"
[11,] "genotype:WT"
[12,] "assay[1]|assay[2]"
[13,] "[MS, MS:1002962, mean, ]"
[14,] "[MS, MS:1002963, variation coefficient, ]"
[15,] "Column: genotype, value: WT"
[16,] "genotype:KO"
[17,] "assay[3]|assay[4]|assay[5]|assay[6]"
[18,] "[MS, MS:1002962, mean, ]"
[19,] "[MS, MS:1002963, variation coefficient, ]"
[20,] "Column: genotype, value: KO"
[21,] "operator:BB"
[22,] "assay[1]|assay[2]|assay[3]|assay[4]"
[23,] "[MS, MS:1002962, mean, ]"
[24,] "[MS, MS:1002963, variation coefficient, ]"
[25,] "Column: operator, value: BB"
[26,] "operator:FB"
[27,] "assay[5]|assay[6]"
[28,] "[MS, MS:1002962, mean, ]"
[29,] "[MS, MS:1002963, variation coefficient, ]"
[30,] "Column: operator, value: FB"              </code></pre>
</div>
</div>
<p>Each unique value in each of the specified columns is encoded as a <code>study_variable</code> (or rather as a <em>study variable value</em>), with its <em>assay_refs</em> attribute containing the rows/assays in which this value was measured. The variable’s <em>description</em> (by default) indicates the name of the column. The <em>average_function</em> and <em>variation_function</em> attributes allow to define the function that was used to calculate the average and variance of the abundance values for that variable value. In upcoming versions a dedicated attribute <em>group</em> can be used to specify the name of the column (i.e. the study variable name) the study variable value is provided in.</p>
<p>We next add the study variable information to the <code>mtd</code>variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mtd</span>, <span class="va">mtd_svar</span><span class="op">)</span></span></code></pre></div>
</div>
<p>At last we sort the elements according to the expected order in the MTD section using the <code><a href="../reference/mtd_sort.html">mtd_sort()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtd_sort.html">mtd_sort</a></span><span class="op">(</span><span class="va">mtd</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This two-column <code>matrix</code> could now be saved to a text file using a tabulator (<code>"\t"</code>) as a field separator. The full metadata header is shown in the table below.</p>
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html" class="external-link">pandoc.table</a></span><span class="op">(</span><span class="va">mtd</span>, style <span class="op">=</span> <span class="st">"rmarkdown"</span>, split.table <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
<table class="table caption-top">
<colgroup>
<col style="width: 37%">
<col style="width: 62%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"> </th>
<th style="text-align: center;"> </th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">mzTab-version</td>
<td style="text-align: center;">2.0.0-M</td>
</tr>
<tr class="even">
<td style="text-align: center;">mzTab-ID</td>
<td style="text-align: center;">id</td>
</tr>
<tr class="odd">
<td style="text-align: center;">title</td>
<td style="text-align: center;">Experiment 1 preprocessed data</td>
</tr>
<tr class="even">
<td style="text-align: center;">description</td>
<td style="text-align: center;">The preprocessed data of the experiment 1.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">instrument[1]-name</td>
<td style="text-align: center;">[MS, MS:1000449, LTQ Orbitrap,]</td>
</tr>
<tr class="even">
<td style="text-align: center;">instrument[1]-source</td>
<td style="text-align: center;">[MS, MS:1000073, ESI,]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">instrument[1]-analyzer[1]</td>
<td style="text-align: center;">[MS, MS:1000291, linear ion trap,]</td>
</tr>
<tr class="even">
<td style="text-align: center;">instrument[1]-detector</td>
<td style="text-align: center;">[MS, MS:1000253, electron multiplier,]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">software[1]</td>
<td style="text-align: center;">[MS, MS:1001582, xcms, 4.1.0]</td>
</tr>
<tr class="even">
<td style="text-align: center;">quantification_method</td>
<td style="text-align: center;">[MS, MS:1001834, LC-MS label-free quantitation analysis, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[1]</td>
<td style="text-align: center;">S1</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[1]-species[1]</td>
<td style="text-align: center;">[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[1]-tissue[1]</td>
<td style="text-align: center;">[BTO, BTO:0000759, liver, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[1]-cell_type[1]</td>
<td style="text-align: center;">[CL, CL:0000182, hepatocyte, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[1]-custom[1]</td>
<td style="text-align: center;">[,,Extraction date, 2011-12-21]</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[2]</td>
<td style="text-align: center;">S2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[2]-species[1]</td>
<td style="text-align: center;">[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[2]-tissue[1]</td>
<td style="text-align: center;">[BTO, BTO:0000759, liver, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[2]-cell_type[1]</td>
<td style="text-align: center;">[CL, CL:0000182, hepatocyte, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[2]-custom[1]</td>
<td style="text-align: center;">[,,Extraction date, 2011-12-22]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[3]</td>
<td style="text-align: center;">S3</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[3]-species[1]</td>
<td style="text-align: center;">[NCBITaxon, NCBITaxon:9606, Homo sapiens, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[3]-tissue[1]</td>
<td style="text-align: center;">[BTO, BTO:0000759, liver, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">sample[3]-cell_type[1]</td>
<td style="text-align: center;">[CL, CL:0000182, hepatocyte, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">sample[3]-custom[1]</td>
<td style="text-align: center;">[,,Extraction date, 2011-12-23]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[1]-location</td>
<td style="text-align: center;">s1-t1.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[1]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[1]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[1]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[2]-location</td>
<td style="text-align: center;">s1-t2.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[2]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[2]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[2]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[3]-location</td>
<td style="text-align: center;">s2-t1.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[3]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[3]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[3]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[4]-location</td>
<td style="text-align: center;">s2-t2.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[4]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[4]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[4]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[5]-location</td>
<td style="text-align: center;">s3-t1.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[5]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[5]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[5]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[6]-location</td>
<td style="text-align: center;">s3-t2.mzML</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[6]-format</td>
<td style="text-align: center;">[MS, MS:1000584, mzML file, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">ms_run[6]-id_format</td>
<td style="text-align: center;">[MS, MS:1000530, mzML unique identifier, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ms_run[6]-scan_polarity[1]</td>
<td style="text-align: center;">[MS, MS:1000130, positive scan, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[1]</td>
<td style="text-align: center;">S1_T1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[1]-sample_ref</td>
<td style="text-align: center;">sample[1]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[1]-ms_run_ref</td>
<td style="text-align: center;">ms_run[1]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[2]</td>
<td style="text-align: center;">S1_T2</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[2]-sample_ref</td>
<td style="text-align: center;">sample[1]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[2]-ms_run_ref</td>
<td style="text-align: center;">ms_run[2]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[3]</td>
<td style="text-align: center;">S2_T1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[3]-sample_ref</td>
<td style="text-align: center;">sample[2]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[3]-ms_run_ref</td>
<td style="text-align: center;">ms_run[3]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[4]</td>
<td style="text-align: center;">S2_T2</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[4]-sample_ref</td>
<td style="text-align: center;">sample[2]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[4]-ms_run_ref</td>
<td style="text-align: center;">ms_run[4]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[5]</td>
<td style="text-align: center;">S3_T1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[5]-sample_ref</td>
<td style="text-align: center;">sample[3]</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[5]-ms_run_ref</td>
<td style="text-align: center;">ms_run[5]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[6]</td>
<td style="text-align: center;">S3_T2</td>
</tr>
<tr class="even">
<td style="text-align: center;">assay[6]-sample_ref</td>
<td style="text-align: center;">sample[3]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assay[6]-ms_run_ref</td>
<td style="text-align: center;">ms_run[6]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[1]</td>
<td style="text-align: center;">timepoint:0h</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[1]-assay_refs</td>
<td style="text-align: center;">assay[1]|assay[3]|assay[5]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[1]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[1]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[1]-description</td>
<td style="text-align: center;">Column: timepoint, value: 0h</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[2]</td>
<td style="text-align: center;">timepoint:6h</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[2]-assay_refs</td>
<td style="text-align: center;">assay[2]|assay[4]|assay[6]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[2]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[2]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[2]-description</td>
<td style="text-align: center;">Column: timepoint, value: 6h</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[3]</td>
<td style="text-align: center;">genotype:WT</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[3]-assay_refs</td>
<td style="text-align: center;">assay[1]|assay[2]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[3]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[3]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[3]-description</td>
<td style="text-align: center;">Column: genotype, value: WT</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[4]</td>
<td style="text-align: center;">genotype:KO</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[4]-assay_refs</td>
<td style="text-align: center;">assay[3]|assay[4]|assay[5]|assay[6]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[4]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[4]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[4]-description</td>
<td style="text-align: center;">Column: genotype, value: KO</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[5]</td>
<td style="text-align: center;">operator:BB</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[5]-assay_refs</td>
<td style="text-align: center;">assay[1]|assay[2]|assay[3]|assay[4]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[5]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[5]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[5]-description</td>
<td style="text-align: center;">Column: operator, value: BB</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[6]</td>
<td style="text-align: center;">operator:FB</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[6]-assay_refs</td>
<td style="text-align: center;">assay[5]|assay[6]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[6]-average_function</td>
<td style="text-align: center;">[MS, MS:1002962, mean, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">study_variable[6]-variation_function</td>
<td style="text-align: center;">[MS, MS:1002963, variation coefficient, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">study_variable[6]-description</td>
<td style="text-align: center;">Column: operator, value: FB</td>
</tr>
<tr class="even">
<td style="text-align: center;">cv[1]-label</td>
<td style="text-align: center;">MS</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cv[1]-full_name</td>
<td style="text-align: center;">PSI-MS controlled vocabulary</td>
</tr>
<tr class="even">
<td style="text-align: center;">cv[1]-version</td>
<td style="text-align: center;">4.1.138</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cv[1]-uri</td>
<td style="text-align: center;">https://raw.githubusercontent.com/HUPO-PSI/psi-ms-CV/master/psi-ms.obo</td>
</tr>
<tr class="even">
<td style="text-align: center;">cv[2]-label</td>
<td style="text-align: center;">PRIDE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cv[2]-full_name</td>
<td style="text-align: center;">PRIDE PRoteomics IDEntifications (PRIDE) database controlled vocabulary</td>
</tr>
<tr class="even">
<td style="text-align: center;">cv[2]-version</td>
<td style="text-align: center;">16:10:2023 11:38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cv[2]-uri</td>
<td style="text-align: center;">https://www.ebi.ac.uk/ols/ontologies/pride</td>
</tr>
<tr class="even">
<td style="text-align: center;">database[1]</td>
<td style="text-align: center;">[,, “no database”, null ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">database[1]-prefix</td>
<td style="text-align: center;">null</td>
</tr>
<tr class="even">
<td style="text-align: center;">database[1]-version</td>
<td style="text-align: center;">Unknown</td>
</tr>
<tr class="odd">
<td style="text-align: center;">database[1]-uri</td>
<td style="text-align: center;">null</td>
</tr>
<tr class="even">
<td style="text-align: center;">small_molecule-quantification_unit</td>
<td style="text-align: center;">[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">small_molecule_feature-quantification_unit</td>
<td style="text-align: center;">[PRIDE, PRIDE:0000330, Arbitrary quantification unit, ]</td>
</tr>
<tr class="even">
<td style="text-align: center;">small_molecule-identification_reliability</td>
<td style="text-align: center;">[MS, MS:1002896, compound identification confidence level, ]</td>
</tr>
</tbody>
</table></section></section><section class="level3"><h4 id="reading-and-importing">Reading and importing<a class="anchor" aria-label="anchor" href="#reading-and-importing"></a>
</h4>
<p>TODO: implement these functions moving the respective code from the legacy repo</p>
</section><section class="level3"><h4 id="general-utility-functions">General utility functions<a class="anchor" aria-label="anchor" href="#general-utility-functions"></a>
</h4>
<p>General utility functions include:</p>
<ul>
<li>
<code><a href="../reference/mtd_fields.html">mtd_fields()</a></code>: to format values in the mzTab-M-specific format.</li>
<li>
<code><a href="../reference/mtd_sort.html">mtd_sort()</a></code>: to sort rows of the metadata <code>matrix</code> into the expected order.</li>
</ul></section></section></section><section class="section level2"><h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R Under development (unstable) (2025-12-07 r89119)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] pander_0.6.6   RmzTabM_0.97.2

loaded via a namespace (and not attached):
 [1] compiler_4.6.0  fastmap_1.2.0   cli_3.6.5       tools_4.6.0
 [5] htmltools_0.5.9 yaml_2.3.12     Rcpp_1.1.0.8.1  rmarkdown_2.30
 [9] knitr_1.50      jsonlite_2.0.0  xfun_0.54       digest_0.6.39
[13] rlang_1.1.6     evaluate_1.0.5 </code></pre>
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nils Hoffmann, Steffen Neumann, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
